<!DOCTYPE html>
<html>
  <head>
    <style>
      .featured-products-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .slider-container {
        position: relative;
        overflow: hidden;
      }

      .products-slider {
        display: flex;
        transition: transform 0.3s ease-in-out;
        gap: 20px;
      }

      .product-card {
        min-width: calc(25% - 15px);
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 12px;
        position: relative;
        background: white;
      }

      .product-image {
        width: 100%;
        aspect-ratio: 1;
        object-fit: cover;
        border-radius: 4px;
      }

      .product-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #db5807;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
      }

      .wish-icon {
        position: absolute;
        top: 10px;
        right: 10px;
        background: white;
        border-radius: 50%;
        padding: 8px;
        cursor: pointer;
      }

      .slider-button {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: white;
        border: 1px solid #eee;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1;
      }

      .prev-button {
        left: -20px;
      }

      .next-button {
        right: -20px;
      }

      .product-content {
        margin-top: 12px;
      }

      .product-category,
      .product-brand {
        color: #db5807;
        font-size: 14px;
      }

      .product-name {
        margin: 8px 0;
        font-weight: bold;
      }

      .description {
        font-size: 14px;
        color: #666;
        margin-bottom: 8px;
      }

      .rating {
        color: #ffd43b;
        margin-bottom: 8px;
      }

      .price {
        font-weight: bold;
        font-size: 18px;
      }

      .add-to-cart {
        background: #db5807;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="featured-products-container">
      <h2>Featured Products</h2>
      <div class="slider-container">
        <button class="slider-button prev-button">←</button>
        <div class="products-slider"></div>
        <button class="slider-button next-button">→</button>
      </div>
    </div>

    <script>
      let currentIndex = 0;
      let products = [];
      const productsPerView = 4;

      async function fetchProducts() {
        try {
          const response = await fetch("http://localhost:3000/api/products");
          const allProducts = await response.json();
          products = allProducts.slice(0, 8); // Display only 8 products
          renderProducts();
          setupSlider();
        } catch (error) {
          console.error("Error fetching products:", error);
        }
      }

      function renderProducts() {
        const container = document.querySelector(".products-slider");
        container.innerHTML = "";

        products.forEach((product) => {
          const productCard = document.createElement("div");
          productCard.className = "product-card";

          productCard.innerHTML = `
                    ${
                      product.discountPercentage
                        ? `<span class="product-badge">${Math.round(
                            product.discountPercentage
                          )}% OFF</span>`
                        : ""
                    }
                    <span class="wish-icon">
                        <i class="fa-regular fa-heart"></i>
                    </span>
                    <img src="${product.thumbnail}" alt="${
            product.name
          }" class="product-image">
                    <div class="product-content">
                        <div style="display: flex; justify-content: space-between;">
                            <div class="product-category">${
                              product.category
                            }</div>
                            <div class="product-brand">${product.brand}</div>
                        </div>
                        <h3 class="product-name">${product.name}</h3>
                        <div class="description">${product.description.substring(
                          0,
                          60
                        )}...</div>
                        <div class="rating">
                            <i class="fa-solid fa-star"></i> ${product.rating}
                        </div>
                        <hr>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                            <div class="price">$${product.price}</div>
                            <button class="add-to-cart">
                                <i class="fa-solid fa-cart-plus"></i> Add to Cart
                            </button>
                        </div>
                    </div>
                `;

          container.appendChild(productCard);
        });
      }

      function setupSlider() {
        const slider = document.querySelector(".products-slider");
        const prevButton = document.querySelector(".prev-button");
        const nextButton = document.querySelector(".next-button");

        function updateSliderPosition() {
          const cardWidth = slider.querySelector(".product-card").offsetWidth;
          const translateX = -currentIndex * (cardWidth + 20); // 20px is the gap
          slider.style.transform = `translateX(${translateX}px)`;
        }

        prevButton.addEventListener("click", () => {
          if (currentIndex > 0) {
            currentIndex--;
            updateSliderPosition();
          }
        });

        nextButton.addEventListener("click", () => {
          if (currentIndex < products.length - productsPerView) {
            currentIndex++;
            updateSliderPosition();
          }
        });
      }

      // Initialize
      fetchProducts();
    </script>

    <!-- Add Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </body>
</html>
